"0","cv.loess <- function(formula, datos, p) {"
"0","  n <- nrow(datos)"
"0","  cv.pred <- numeric(n)"
"0","  for (i in 1:n) {"
"0","    modelo <- loess(formula, datos[-i, ], span = p, "
"0","                    control = loess.control(surface = ""direct""))"
"0","    # control = loess.control(surface = ""direct"") permite extrapolaciones"
"0","    cv.pred[i] <- predict(modelo, newdata = datos[i, ])"
"0","  }"
"0","  return(cv.pred)"
"0","}"
